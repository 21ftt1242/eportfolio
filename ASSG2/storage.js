 //localStorage

 localStorage.setItem('story-1a', 'Once when I was six years old I saw a magnificent picture in a book, called True Stories from Nature, about the primeval forest. It was a picture of a boa constrictor in the act of swallowing an animal. Here is a copy of the drawing. In the book it said: "Boa constrictors swallow their prey whole, without chewing it. After that they are not able to move, and they sleep through the six months that they need for digestion." I pondered deeply, then, over the adventures of the jungle. And after some work with a colored pencil I succeeded in making my first drawing. My Drawing Number One. It looked like this: <img src="images/story1-img2.png">');
 localStorage.setItem('story-1b', 'I showed my masterpiece to the grown-ups, and asked them whether the drawing frightened them. But they answered: "Frighten? Why should any one be frightened by a hat?" My drawing was not a picture of a hat. It was a picture of a boa constrictor digesting an elephant. But since the grown-ups were not able to understand it, I made another drawing: I drew the inside of the boa constrictor, so that the grown-ups could see it clearly. They always need to have things explained. My Drawing Number Two looked like this: <br> <img src="images/story1-img2.png">');
 localStorage.setItem('story-1c', 'The grown-ups\' response, this time, was to advise me to lay aside my drawings of boa constrictors, whether from the inside or the outside, and devote myself instead to geography, history, arithmetic and grammar. That is why, at the age of six, I gave up what might have been a magnificent career as a painter. I had been disheartened by the failure of my Drawing Number One and my Drawing Number Two. Grown-ups never understand anything by themselves, and it is tiresome for children to be always and forever explaining things to them.');
 localStorage.setItem('story-1d', 'So then I chose another profession, and learned to pilot airplanes. I have flown a little over all parts of the world; and it is true that geography has been very useful to me. At a glance I can distinguish China from Arizona. If one gets lost in the night, such knowledge is valuable. In the course of this life I have had a great many encounters with a great many people who have been concerned with matters of consequence. I have lived a great deal among grown-ups. I have seen them intimately, close at hand. And that hasn\'t much improved my opinion of them. Whenever I met one of them who seemed to me at all clear-sighted, I tried the experiment of showing him my Drawing Number One, which I have always kept. I would try to find out, so, if this was a person of true understanding. But, whoever it was, he, or she, would always say: "That is a hat."Then I would never talk to that person about boa constrictors, or primeval forests, or stars. I would bring myself down to his level. I would talk to him about bridge, and golf, and politics, and neckties. And the grown-up would be greatly pleased to have met such a sensible man.');
 localStorage.setItem('story-1a-m', 'Suatu ketika ketika saya berumur enam tahun, saya melihat gambar yang indah dalam sebuah buku, yang disebut Kisah Benar dari Alam, tentang hutan purba. Ia adalah gambar seekor boa constrictor dalam tindakan menelan haiwan. Berikut adalah salinan lukisan tersebut. Dalam buku itu ia berkata: "Boa constrictors menelan mangsa mereka keseluruhan, tanpa mengunyahnya. Selepas itu mereka tidak dapat bergerak, dan mereka tidur melalui enam bulan yang mereka perlukan untuk penghadaman." Saya merenung sedalam-dalamnya, tentang pengembaraan hutan. Dan selepas beberapa kerja dengan pensel warna saya berjaya membuat lukisan pertama saya. Lukisan Saya Nombor Satu. Ia kelihatan seperti ini:');
 localStorage.setItem('story-1b-m', 'Saya menunjukkan karya agung saya kepada orang dewasa, dan bertanya kepada mereka sama ada lukisan itu menakutkan mereka. Tetapi mereka menjawab: "Takut? Mengapa ada orang yang takut dengan topi?" Lukisan saya bukan gambar topi. Ia adalah gambar seekor boa constrictor sedang mencerna seekor gajah. Tetapi kerana orang dewasa tidak dapat memahaminya, saya membuat lukisan lain: Saya melukis bahagian dalam boa constrictor, supaya orang dewasa dapat melihatnya dengan jelas. Mereka sentiasa perlu menjelaskan sesuatu. Lukisan Nombor Dua Saya kelihatan seperti ini:');
 localStorage.setItem('story-1c-m', 'Tanggapan orang dewasa, kali ini, adalah menasihati saya supaya mengenepikan lukisan boa constrictors saya, sama ada dari dalam atau luar, dan sebaliknya menumpukan diri saya kepada geografi, sejarah, aritmetik dan tatabahasa. Itulah sebabnya, pada usia enam tahun, saya melepaskan apa yang mungkin merupakan kerjaya yang hebat sebagai pelukis. Saya telah kecewa dengan kegagalan Lukisan Nombor Satu dan Lukisan Nombor Dua saya. Orang dewasa tidak pernah memahami apa-apa dengan sendirinya, dan ia memenatkan untuk kanak-kanak sentiasa dan selama-lamanya menerangkan perkara kepada mereka.')
 localStorage.setItem('story-1d-m', 'Jadi saya memilih profesion lain, dan belajar memandu kapal terbang. Saya telah terbang sedikit ke seluruh dunia; dan memang benar bahawa geografi sangat berguna kepada saya. Sekali imbas saya boleh membezakan China dengan Arizona. Jika seseorang tersesat di malam hari, ilmu itu berharga. Dalam perjalanan hidup ini saya telah mengalami banyak perjumpaan dengan ramai orang yang mengambil berat tentang perkara akibat. Saya telah banyak hidup dalam kalangan orang dewasa. Saya telah melihat mereka secara dekat, dekat. Dan itu tidak banyak meningkatkan pendapat saya tentang mereka. Setiap kali saya bertemu dengan salah seorang daripada mereka yang pada pandangan saya kelihatan jelas, saya mencuba percubaan menunjukkan kepadanya Lukisan Nombor Satu saya, yang selalu saya simpan. Saya akan cuba mencari tahu, jadi, jika ini adalah orang yang benar-benar memahami. Tetapi, sesiapa sahaja, dia, atau dia, akan sentiasa berkata: "Itu adalah topi." Kemudian saya tidak akan bercakap dengan orang itu tentang boa constrictors, atau hutan purba, atau bintang. Saya akan membawa diri saya ke tahap dia. Saya akan bercakap dengannya tentang jambatan, dan golf, dan politik, dan tali leher. Dan orang dewasa akan sangat gembira dapat bertemu dengan lelaki yang bijak.')
 localStorage.setItem('story-2a', 'Once it was about one in the morning, the three of us headed back up to the room (our other three friends were already up there) and changed to go to sleep. Of course, we\'re all pretty young (no one above 21) so we logically stayed up awhile to talk. Our room was one of those annoying ones where you can\'t do anything to close the curtains, so they were wide open and some of us were just staring out the window while we talked. <br><br>After we\'d been talking awhile, one friend said, “Hey, what\'s that in the window over there?”');
  localStorage.setItem('story-2b', 'All of us sat up to look, but it was hard to see from the beds so we ended up with all six of us crowded at the window, just staring across the way. Over there it was another hotel, where there was this long line (up and down) of windows. Most of the curtains there were closed, lights off, and so on. One window was different though. <br><br>The curtain was open, and we could see a figure standing there. It looked like a guy, sort of swaying back and forth. I brought up that it reminded me of the scene in 1408 and was immediately ordered to shut up. So we kept watching. The figure kept swaying. Someone mentioned Slenderman. It just kept on moving.');
  localStorage.setItem('story-2c', 'I think we were all at the window for a good 15 or 20 minutes, and it just kept moving. I think everyone said at least one thing that it could have been - the worst of which was the idea that someone hanged themselves over there. <br> <br> Eventually we all forced ourselves to go back and lay down, since were all pretty creeped out at that point. Before we fell asleep we mentioned how it would be even worse if it wasn\'t there the next night, because if it wasn\'t there anymore... well, what could it have been? If it was still there, it was just part of the hotel room.');
  localStorage.setItem('story-2d', 'Once we got back to the room the next night, we checked the window across the way. <br> <br> There was nothing there.');
// Story 1 variables
var s1_p1a_en = localStorage.getItem("story-1a");
var s1_p1b_en = localStorage.getItem("story-1b");
var s1_p2a_en = localStorage.getItem("story-1c");
var s1_p2b_en = localStorage.getItem("story-1d");
var s1_p1a_mal = localStorage.getItem("story-1a-m");
var s1_p1b_mal = localStorage.getItem("story-1b-m");
var s1_p2a_mal = localStorage.getItem("story-1c-m");
var s1_p2b_mal = localStorage.getItem("story-1d-m");
var s2_p1a_en = localStorage.getItem("story-2a");
var s2_p1b_en = localStorage.getItem("story-2b");
var s2_p2a_en = localStorage.getItem("story-2c");
var s2_p2b_en = localStorage.getItem("story-2d");


// Declare variables
var playButton = document.getElementById("play-button");
var pauseButton = document.getElementById("pause-button");
var stopButton = document.getElementById("stop-button");
var voiceSelect = document.getElementById("voice-select");
var synth = window.speechSynthesis;
var langSelect = document.getElementById("lang-select");
var text;
var text2;
var text3;
var pageOne;
var pageNum = localStorage.getItem('page');
var saveFont;
var saveFont2;

// Current Story variables
var currentStoryEN_1;
var currentStoryEN_2;
var currentStoryMAL_1;
var currentStoryMAL_2;

var inputVoice = document.getElementById("voice-select");
var inputLang = document.getElementById("lang-select");

function storyLoad() {
  console.log("storyLoad is loaded!");
  console.log(pageNum);
  switch (pageNum) {
    case '1': 
    currentStoryEN_1 = s1_p1a_en;
    currentStoryEN_2 = s1_p1b_en;
    currentStoryMAL_1 = s1_p1a_mal;
    currentStoryMAL_2 = s1_p1b_mal;
    console.log("hey test");
    break;

    case '2':
    currentStoryEN_1 = s1_p2a_en;
    currentStoryEN_2 = s1_p2b_en;
    currentStoryMAL_1 = s1_p2a_mal;
    currentStoryMAL_2 = s1_p2b_mal; 
    console.log("hey testtttttt");
    break;

    case '3':
    currentStoryEN_1 = s2_p1a_en;
    currentStoryEN_2 = s2_p1b_en;
    break;

    case '4':
    currentStoryEN_1 = s2_p2a_en;
    currentStoryEN_2 = s2_p2b_en;
    break;
  }
  //call function on page loads
  loadSize();
  changeVoice();
  changeLang();
  saveVoice();
}

function loadSize() {
  var text1 = document.getElementById("content1");
  var text2 = document.getElementById("content2");
  if (localStorage.getItem('size') == "small") {
    text1.style.fontSize = "0.5em";
    text2.style.fontSize = "0.5em";
  }
  else if (localStorage.getItem('size') == "medium") {
    text1.style.fontSize = "1em";
    text2.style.fontSize = "1em";
  }
  else if (localStorage.getItem('size') == "large") {
    text1.style.fontSize = "2em";
    text2.style.fontSize = "2em";
  }
}
function changeLang() {
  if (langSelect.value === "english") {
    document.getElementById("content1").innerHTML = currentStoryEN_1;
    document.getElementById("content2").innerHTML = currentStoryEN_2;
  } else if (langSelect.value === "malay") {
    document.getElementById("content1").innerHTML = currentStoryMAL_1;
    document.getElementById("content2").innerHTML = currentStoryMAL_2;
  }
  text = document.getElementById("content1").innerText;
  text2 = document.getElementById("content2").innerText;
  text3 = text + text2;
  pageOne = new SpeechSynthesisUtterance(text3);
}

function changeVoice() {
  if (localStorage['voice-select']) {
    inputVoice.value = localStorage['voice-select'];
  }

  if (localStorage['lang-select']) {
  inputLang.value = localStorage['lang-select'];
  }
}


// Array of voices
let voices = [];

// ----------Call Populate Voice function----------
populateVoices();


// ----------Populate Voice function----------
function populateVoices() {
  voices = synth.getVoices();
  // Loop through voices and create option for each one
  voices.forEach(voice => {
  
    // Create option element
    let listItem = document.createElement('option');
  
    // Fill option with voice and language
    listItem.textContent = voice.name + '('+ voice.lang +')';

    // Set needed listItem attributes
    listItem.setAttribute('data-lang', voice.lang);
    listItem.setAttribute('data-name', voice.name);
    voiceSelect.appendChild(listItem);
  });
};

if(synth.onvoiceschanged !== undefined) {
  synth.onvoiceschanged = populateVoices;
}

// ----------Play Button----------

function playText() {
  let selectedVoice = voiceSelect.selectedOptions[0].getAttribute('data-name');

  voices.forEach((voice) => {
    if(voice.name === selectedVoice) {
    pageOne.voice = voice;
      }
    });

  synth.speak(pageOne);

  if (speechSynthesis.paused && speechSynthesis.speaking) {
    return speechSynthesis.resume();
  }
};

// ----------Pause Button----------

function pauseText() {
  if (speechSynthesis.speaking) {
    speechSynthesis.pause();
  }
}

// ----------Stop Button----------

function stopText() {
  speechSynthesis.resume();
  speechSynthesis.cancel();
}

// -----------Save Preferences----------
function saveVoice() {
 localStorage['voice-select'] = inputVoice.value;
 localStorage['lang-select'] = inputLang.value;
 
 if (saveFont == 1) {
  localStorage.setItem('size', 'small');
 }
 else if (saveFont == 2) {
  localStorage.setItem('size', 'medium');
 }
 else if (saveFont == 3) {
  localStorage.setItem('size', 'large');
 }
}


// -----------Reset Preferences-----------
function resetVoice() {
  voiceSelect.selectedIndex = 0;
  langSelect.selectedIndex = 0;
  localStorage.removeItem('voice-select');
  localStorage.removeItem('lang-select');
  localStorage.removeItem('size');
}

function toSmall() {
  saveFont = 1;
  var text1 = document.getElementById("content1");
  var text2 = document.getElementById("content2");
  text1.style.fontSize = "0.5em";
  text2.style.fontSize = "0.5em";
}

function toMedium() {
  saveFont = 2;
  var text1 = document.getElementById("content1");
  var text2 = document.getElementById("content2");
  text1.style.fontSize = "1em";
  text2.style.fontSize = "1em";
}

function toLarge() {
  saveFont = 3;
  var text1 = document.getElementById("content1");
  var text2 = document.getElementById("content2");
  text1.style.fontSize = "2em";
  text2.style.fontSize = "2em";
}
